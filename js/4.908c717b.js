(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[4],{"7eef":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"q-py-md q-px-xl main"},[a("div",{staticClass:"section"},[a("div",{staticClass:"title text-weight-bold"},[e._v("组长")]),a("div",{staticClass:"manage"},[a("member",{attrs:{members:[e.owner]}}),e.canManage?a("q-btn",{staticClass:"manage-btn",attrs:{outline:"",label:this.editMember?"停止编辑":"管理组员",color:this.editMember?"negative":"primary"},on:{click:e.edit}}):e._e()],1)]),a("div",{staticClass:"section"},[a("div",{staticClass:"title text-weight-bold"},[e._v("\n      所有成员\n      "),e.canManage?a("q-btn",{staticClass:"manage-btn",attrs:{outline:"",label:"手动添加成员",color:"primary"},on:{click:e.linkMember}}):e._e()],1),a("member",{attrs:{members:e.pagedAliveMember,edit:e.editMember},on:{changeBlockStatus:e.changeBlockStatus}})],1),a("div",{staticClass:"q-pa-md flex flex-center"},[a("q-pagination",{attrs:{max:e.maxPage,"max-pages":9,"boundary-numbers":!0,"direction-links":!0,color:"primary"},model:{value:e.currentPage,callback:function(t){e.currentPage=t},expression:"currentPage"}}),a("span",{staticClass:"total"},[e._v("共"+e._s(this.aliveMember.length)+"人")])],1),a("div",[a("div",{staticClass:"title text-weight-bold"},[e._v("小黑屋")]),a("member",{attrs:{members:e.blockMember,edit:e.editMember,blocked:!0},on:{changeBlockStatus:e.changeBlockStatus}})],1),a("q-dialog",{model:{value:e.showBandingMember,callback:function(t){e.showBandingMember=t},expression:"showBandingMember"}},[a("q-card",{staticStyle:{width:"420px"}},[a("q-card-section",[a("div",{staticClass:"text-h6"},[e._v("添加成员")])]),a("q-btn-toggle",{attrs:{spread:"","no-caps":"","toggle-color":"primary",color:"white","text-color":"primary",options:[{label:"绑定Moonbbs板块",value:"one"},{label:"绑定Twitter成员",value:"two"}]},model:{value:e.selectMood,callback:function(t){e.selectMood=t},expression:"selectMood"}}),a("q-card-section",[a("q-input",{attrs:{square:"",outlined:"",label:"板块ID"},model:{value:e.tw_input,callback:function(t){e.tw_input=t},expression:"tw_input"}})],1),a("q-card-actions",{attrs:{align:"right"}},[a("q-btn",{attrs:{flat:"",label:"OK",color:"primary"},on:{click:e.submit}})],1)],1)],1)],1)},n=[],r=(a("28a5"),a("20d6"),a("967e")),s=a.n(r),o=(a("96cf"),a("fa84")),c=a.n(o),l=a("eeee"),u={components:{member:l["a"]},props:{id:String},computed:{owner:function(){return this.$store.state.group.currentGroupOwner},canManage:function(){return this.$store.state.group.currentGroupOwner.id===this.$store.state.user.userid},maxPage:function(){return this.aliveMember.length&&Math.floor(this.aliveMember.length/this.pageSize)+1},pagedAliveMember:function(){return this.aliveMember.slice((this.currentPage-1)*this.pageSize,this.currentPage*this.pageSize)}},data:function(){return{currentPage:1,aliveMember:[],blockMember:[],editMember:!1,pageSize:30,showBandingMember:!1,selectMood:"one",tw_input:""}},created:function(){this.$store.dispatch("group/jumpToGroup",{id:this.id}),this.getMembers(this.id)},methods:{getMembers:function(e){var t=this;return c()(s.a.mark((function a(){var i,n;return s.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return i="/user/members/"+e,a.next=3,t.$axios.get(i);case 3:n=a.sent,0==n.data.code&&(t.aliveMember=n.data.data.alive,t.blockMember=n.data.data.blocked);case 5:case"end":return a.stop()}}),a)})))()},changeBlockStatus:function(e){var t=e.userId,a=e.type;if("block"===a){var i=this.aliveMember.findIndex((function(e){return e.id===t}));this.blockMember.push(this.aliveMember[i]),this.aliveMember.splice(i,1)}else if("unblock"===a){var n=this.blockMember.findIndex((function(e){return e.id===t}));this.aliveMember.push(this.blockMember[n]),this.blockMember.splice(n,1)}},edit:function(){this.editMember=!this.editMember},linkMember:function(){this.showBandingMember=!0},submit:function(){var e=this;return c()(s.a.mark((function t(){var a,i,n;return s.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.tw_input){t.next=2;break}return t.abrupt("return",e.$q.notify("请输入id"));case 2:if("one"!==e.selectMood){t.next=13;break}if(a="/protected/moon/categories",i={grp:+e.id,categories:e.tw_input.split(",").map((function(e){return+e}))},!i.categories.some((function(e){return isNaN(e)}))){t.next=7;break}return t.abrupt("return",e.$q.notify("请检查输入"));case 7:return t.next=9,e.$axios.put(a,i);case 9:n=t.sent,0===n.data.code?(e.$q.notify("添加成功"),e.showBandingMember=!1):e.$q.notify("操作失败"),t.next=14;break;case 13:e.$q.notify("此功能尚未上线");case 14:case"end":return t.stop()}}),t)})))()}}},d=u,b=(a("91c8"),a("2877")),m=a("eebe"),p=a.n(m),h=a("2c91"),g=a("9c40"),f=a("3b16"),v=a("24e8"),M=a("f09f"),w=a("a370"),k=a("6a67"),x=a("27f9"),q=a("4b7e"),_=Object(b["a"])(d,i,n,!1,null,"8e544994",null);t["default"]=_.exports;p()(_,"components",{QSpace:h["a"],QBtn:g["a"],QPagination:f["a"],QDialog:v["a"],QCard:M["a"],QCardSection:w["a"],QBtnToggle:k["a"],QInput:x["a"],QCardActions:q["a"]})},"91c8":function(e,t,a){"use strict";var i=a("ddc6"),n=a.n(i);n.a},ddc6:function(e,t,a){}}]);